<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zain Developer | AI Photo to Anime Converter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Global Styles & Variables */
        :root {
            --primary: #7a5af5;
            --primary-dark: #6a4ae3;
            --secondary: #ff6b9d;
            --accent: #00d4ff;
            --accent-glow: rgba(0, 212, 255, 0.5);
            --dark-bg: #0a0a1a;
            --dark-card: #12122a;
            --darker-card: #0c0c1f;
            --text-primary: #ffffff;
            --text-secondary: #b0b0d0;
            --border-color: #2a2a4a;
            --success: #00e676;
            --error: #ff4757;
            --warning: #ffaa00;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--accent) 100%);
            --gradient-dark: linear-gradient(135deg, var(--dark-card) 0%, var(--darker-card) 100%);
            --cyber-gradient: linear-gradient(45deg, #00d4ff, #7a5af5, #ff6b9d);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(122, 90, 245, 0.15) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(255, 107, 157, 0.15) 0%, transparent 20%);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            padding: 30px 0;
            text-align: center;
            background: rgba(10, 10, 26, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient);
            opacity: 0.05;
            z-index: -1;
        }

        .logo {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 10px;
        }

        .logo-icon {
            font-size: 2.5rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            animation: pulse 2s infinite;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            font-size: 2.8rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 300;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 20px;
        }

        .tagline {
            color: var(--accent);
            font-weight: 500;
            max-width: 600px;
            margin: 0 auto;
            padding: 10px 20px;
            background: rgba(0, 212, 255, 0.1);
            border-radius: 50px;
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        /* Settings Button */
        .settings-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--gradient);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 5px 15px rgba(122, 90, 245, 0.4);
            transition: all 0.3s;
        }

        .settings-btn:hover {
            transform: rotate(30deg);
            box-shadow: 0 8px 20px rgba(122, 90, 245, 0.6);
        }

        .settings-btn i {
            font-size: 1.5rem;
            color: white;
        }

        .settings-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--dark-card);
            border-radius: 15px;
            padding: 20px;
            width: 280px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 100;
            display: none;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.3s, transform 0.3s;
        }

        .settings-panel.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .settings-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--accent);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .setting-item {
            margin-bottom: 15px;
        }

        .setting-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .setting-select {
            width: 100%;
            padding: 10px;
            background: var(--darker-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            cursor: pointer;
        }

        /* Main Content */
        main {
            padding: 40px 0;
        }

        .converter-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (min-width: 992px) {
            .converter-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Panel Styles */
        .panel {
            background: var(--gradient-dark);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }

        .panel-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-title i {
            font-size: 1.3rem;
        }

        /* Upload Area */
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 25px;
            position: relative;
        }

        .upload-area:hover, .upload-area.dragover {
            border-color: var(--primary);
            background: rgba(122, 90, 245, 0.05);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .upload-subtext {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .file-input {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            cursor: pointer;
        }

        /* Image Preview */
        .image-preview {
            display: none;
            margin-top: 25px;
            text-align: center;
        }

        .image-preview.active {
            display: block;
        }

        .preview-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--text-secondary);
        }

        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        /* Style Selection */
        .style-selection {
            margin-bottom: 30px;
        }

        .style-label {
            display: block;
            margin-bottom: 12px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .style-select {
            width: 100%;
            padding: 15px;
            background: var(--darker-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .style-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .style-select option {
            background: var(--dark-card);
            color: var(--text-primary);
            padding: 10px;
        }

        /* Convert Button */
        .convert-btn {
            width: 100%;
            padding: 18px;
            background: var(--gradient);
            border: none;
            border-radius: 12px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(122, 90, 245, 0.4);
        }

        .convert-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(122, 90, 245, 0.6);
        }

        .convert-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            background: var(--border-color);
        }

        /* MODERN LOADING SYSTEM STYLES */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 26, 0.98);
            backdrop-filter: blur(15px);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .loading-overlay.active {
            display: flex;
            opacity: 1;
        }

        /* Modern AI Loading (Version 1) */
        .modern-loading {
            width: 100%;
            max-width: 500px;
            text-align: center;
            padding: 30px;
            display: block;
        }

        .loading-header {
            margin-bottom: 30px;
        }

        .loading-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .loading-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Circular Loading */
        .circular-loader {
            position: relative;
            width: 220px;
            height: 220px;
            margin: 0 auto 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .outer-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                var(--primary) 0deg,
                var(--secondary) 120deg,
                var(--accent) 240deg,
                var(--primary) 360deg
            );
            position: absolute;
            animation: rotate 3s linear infinite;
            box-shadow: 0 0 40px rgba(122, 90, 245, 0.4);
            padding: 10px;
        }

        .outer-circle::before {
            content: '';
            position: absolute;
            width: calc(100% - 20px);
            height: calc(100% - 20px);
            background: var(--dark-card);
            border-radius: 50%;
            top: 10px;
            left: 10px;
            z-index: 1;
        }

        .image-preview-container {
            position: relative;
            width: 180px;
            height: 180px;
            border-radius: 50%;
            overflow: hidden;
            z-index: 2;
            border: 3px solid var(--border-color);
            box-shadow: 
                inset 0 0 20px rgba(0, 0, 0, 0.5),
                0 0 30px rgba(122, 90, 245, 0.3);
            background: var(--darker-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preview-image-loading {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            filter: brightness(1.1) contrast(1.05);
            transition: transform 0.5s ease;
        }

        .preview-image-loading.loading {
            animation: pulseImage 2s ease-in-out infinite;
        }

        .scan-line {
            position: absolute;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            animation: scan 2s ease-in-out infinite;
            z-index: 3;
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .pulse-ring {
            position: absolute;
            width: 240px;
            height: 240px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            animation: pulse 2s ease-out infinite;
            z-index: 0;
            opacity: 0.6;
        }

        /* Progress & Status */
        .loading-status {
            margin-bottom: 25px;
            min-height: 70px;
        }

        .status-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            color: var(--accent);
            margin-bottom: 10px;
            letter-spacing: 1px;
            min-height: 2rem;
        }

        .status-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            min-height: 1.5rem;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .progress-text {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent);
            font-size: 1.2rem;
        }

        .progress-time {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: var(--darker-card);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--border-color);
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: var(--gradient);
            border-radius: 10px;
            position: relative;
            transition: width 0.3s ease;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shine 2s infinite;
        }

        .loading-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            position: relative;
        }

        .loading-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 10%;
            right: 10%;
            height: 2px;
            background: var(--border-color);
            z-index: 1;
        }

        .step {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--darker-card);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            z-index: 2;
            position: relative;
            transition: all 0.5s ease;
        }

        .step.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 0 15px var(--primary);
        }

        .step.completed {
            background: var(--accent);
            border-color: var(--accent);
            color: var(--dark-bg);
        }

        .step-label {
            position: absolute;
            top: 38px;
            font-size: 0.7rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        /* Cyberpunk Loading - Version 2 */
        .cyberpunk-loading {
            width: 100%;
            max-width: 600px;
            text-align: center;
            padding: 30px;
            display: none;
        }

        .cyber-header {
            margin-bottom: 40px;
        }

        .cyber-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            color: transparent;
            background: var(--cyber-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        .cyber-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .cyber-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .cyber-visual {
            display: flex;
            align-items: center;
            gap: 30px;
            width: 100%;
        }

        .cyber-image-frame {
            width: 200px;
            height: 200px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            border: 3px solid transparent;
            background: linear-gradient(45deg, var(--primary), var(--accent), var(--secondary)) border-box;
            -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: destination-out;
            mask-composite: exclude;
            box-shadow: 0 0 30px rgba(122, 90, 245, 0.3);
        }

        .cyber-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            filter: brightness(1.1) contrast(1.05);
        }

        .cyber-scan {
            position: absolute;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            top: 0;
            left: 0;
            animation: cyber-scan 2s linear infinite;
            box-shadow: 0 0 20px var(--accent-glow);
            z-index: 2;
        }

        .cyber-processor {
            flex: 1;
            height: 200px;
            background: var(--darker-card);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .processor-title {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent);
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-align: left;
        }

        .processor-bars {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .processor-bar {
            height: 12px;
            background: #0f1a2a;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .processor-fill {
            height: 100%;
            width: 0%;
            border-radius: 6px;
            position: relative;
            transition: width 0.5s ease;
        }

        .bar-1 .processor-fill {
            background: linear-gradient(90deg, #00d4ff, #7a5af5);
        }

        .bar-2 .processor-fill {
            background: linear-gradient(90deg, #7a5af5, #ff6b9d);
        }

        .bar-3 .processor-fill {
            background: linear-gradient(90deg, #ff6b9d, #00d4ff);
        }

        .processor-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .cyber-grid {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(0, 212, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 212, 255, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            pointer-events: none;
        }

        .cyber-status {
            width: 100%;
            text-align: left;
        }

        .cyber-status-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--accent);
            margin-bottom: 10px;
            min-height: 2rem;
        }

        .cyber-progress {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 1px solid var(--primary);
            overflow: hidden;
            position: relative;
            margin-bottom: 10px;
        }

        .cyber-progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
        }

        .cyber-progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shine 1.5s infinite;
        }

        .cyber-percentage {
            display: flex;
            justify-content: space-between;
            font-family: 'Orbitron', sans-serif;
            color: var(--text-secondary);
        }

        /* Loading Close Button */
        .loading-close {
            position: absolute;
            top: 30px;
            right: 30px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 1001;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.3);
        }

        .loading-close:hover {
            color: var(--accent);
            transform: scale(1.1);
            background: rgba(0, 212, 255, 0.1);
        }

        /* Result Container */
        .result-container {
            display: none;
            text-align: center;
            animation: fadeIn 0.8s ease;
        }

        .result-container.active {
            display: block;
        }

        .result-title {
            font-size: 1.8rem;
            color: var(--success);
            margin-bottom: 25px;
            font-family: 'Orbitron', sans-serif;
        }

        .result-image {
            max-width: 100%;
            max-height: 400px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            margin-bottom: 30px;
            border: 2px solid var(--primary);
        }

        .result-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .action-btn {
            padding: 15px 30px;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 200px;
            border: none;
        }

        .download-btn {
            background: var(--gradient);
            color: white;
            box-shadow: 0 5px 15px rgba(122, 90, 245, 0.4);
        }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(122, 90, 245, 0.6);
        }

        .another-btn {
            background: transparent;
            color: var(--accent);
            border: 2px solid var(--accent);
        }

        .another-btn:hover {
            background: rgba(0, 212, 255, 0.1);
            transform: translateY(-3px);
        }

        /* Error Messages */
        .error-container {
            display: none;
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid var(--error);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            text-align: center;
            animation: shake 0.5s ease;
        }

        .error-container.active {
            display: block;
        }

        .error-icon {
            font-size: 2rem;
            color: var(--error);
            margin-bottom: 10px;
        }

        .error-text {
            color: var(--error);
            font-weight: 500;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 30px 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
            border-top: 1px solid var(--border-color);
            margin-top: 40px;
            background: rgba(10, 10, 26, 0.9);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .footer-link {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-link:hover {
            color: var(--accent);
        }

        /* Animations */
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes scan {
            0% { transform: translateY(-50%) translateX(-100%); }
            100% { transform: translateY(-50%) translateX(100%); }
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        @keyframes cyber-scan {
            0% { top: 0; }
            100% { top: 100%; }
        }

        @keyframes pulseImage {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px var(--accent-glow); }
            50% { box-shadow: 0 0 25px var(--accent-glow); }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1rem;
                letter-spacing: 2px;
            }
            
            .panel {
                padding: 20px;
            }
            
            .action-btn {
                min-width: 100%;
            }
            
            .result-actions {
                flex-direction: column;
            }
            
            .circular-loader {
                width: 200px;
                height: 200px;
            }
            
            .image-preview-container {
                width: 160px;
                height: 160px;
            }
            
            .cyber-visual {
                flex-direction: column;
            }
            
            .cyber-image-frame, .cyber-processor {
                width: 100%;
            }
            
            .cyber-image-frame {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- Settings Button -->
    <button class="settings-btn" id="settingsBtn">
        <i class="fas fa-cog"></i>
    </button>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-title">
            <i class="fas fa-sliders-h"></i> Loading Settings
        </div>
        
        <div class="setting-item">
            <label class="setting-label">Loading Style</label>
            <select class="setting-select" id="loadingStyleSelect">
                <option value="modern">Modern AI Loading</option>
                <option value="cyberpunk">Cyberpunk Loading</option>
            </select>
        </div>
        
        <div class="setting-item">
            <label class="setting-label">Processing Speed</label>
            <select class="setting-select" id="loadingSpeedSelect">
                <option value="fast">Fast</option>
                <option value="normal" selected>Normal</option>
                <option value="slow">Slow</option>
            </select>
        </div>
        
        <div class="setting-item">
            <label class="setting-label">Image Preview</label>
            <select class="setting-select" id="imagePreviewSelect">
                <option value="enabled" selected>Enabled</option>
                <option value="disabled">Disabled</option>
            </select>
        </div>
        
        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border-color);">
            <div style="color: var(--text-secondary); font-size: 0.8rem;">
                <i class="fas fa-info-circle"></i> Settings will be applied on next conversion.
            </div>
        </div>
    </div>

    <header>
        <div class="container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <h1>Zain Developer</h1>
            </div>
            <div class="subtitle">AI Photo to Anime Converter</div>
            <div class="tagline">Transform your photos into stunning anime art with AI</div>
        </div>
    </header>

    <main class="container">
        <div class="converter-container">
            <!-- Input Panel -->
            <div class="panel">
                <div class="panel-title">
                    <i class="fas fa-upload"></i> Upload Photo
                </div>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <div class="upload-text">Drag & Drop your photo here</div>
                    <div class="upload-subtext">or click to browse (JPG or PNG, max 5MB)</div>
                    <input type="file" id="fileInput" class="file-input" accept=".jpg,.jpeg,.png">
                </div>
                
                <div class="image-preview" id="imagePreview">
                    <div class="preview-title">Original Photo</div>
                    <img id="previewImage" class="preview-image" alt="Preview">
                </div>
                
                <div class="style-selection">
                    <label for="styleSelect" class="style-label">Choose Anime Style</label>
                    <select id="styleSelect" class="style-select">
                        <option value="anime">Anime</option>
                        <option value="ghibli">Ghibli</option>
                        <option value="manga">Manga</option>
                        <option value="blocky">Blocky</option>
                        <option value="chinese-ink">Chinese Ink</option>
                        <option value="minimalist">Minimalist</option>
                    </select>
                </div>
                
                <button id="convertBtn" class="convert-btn" disabled>
                    <i class="fas fa-magic"></i> Convert to Anime
                </button>
                
                <div class="error-container" id="uploadError">
                    <div class="error-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="error-text" id="uploadErrorText">Error message will appear here</div>
                </div>
            </div>
            
            <!-- Output Panel -->
            <div class="panel">
                <div class="panel-title">
                    <i class="fas fa-image"></i> Anime Result
                </div>
                
                <div class="result-container" id="resultContainer">
                    <div class="result-title">Your Anime Art is Ready!</div>
                    <img id="resultImage" class="result-image" alt="Anime Result">
                    
                    <div class="result-actions">
                        <button id="downloadBtn" class="action-btn download-btn">
                            <i class="fas fa-download"></i> Download Image
                        </button>
                        <button id="anotherBtn" class="action-btn another-btn">
                            <i class="fas fa-redo"></i> Convert Another
                        </button>
                    </div>
                </div>
                
                <div class="error-container" id="apiError">
                    <div class="error-icon">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <div class="error-text" id="apiErrorText">API error message will appear here</div>
                </div>
                
                <div id="defaultOutput" style="text-align: center; padding: 60px 20px;">
                    <div style="font-size: 4rem; color: var(--border-color); margin-bottom: 20px;">
                        <i class="fas fa-image"></i>
                    </div>
                    <div style="font-size: 1.2rem; color: var(--text-secondary); margin-bottom: 10px;">
                        Your anime art will appear here
                    </div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        Upload a photo and click "Convert to Anime"
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modern Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <button class="loading-close" id="closeLoadingBtn">
            <i class="fas fa-times"></i>
        </button>
        
        <!-- Modern AI Loading (Version 1) -->
        <div class="modern-loading" id="modernLoading">
            <div class="loading-header">
                <div class="loading-title">AI Processing</div>
                <div class="loading-subtitle">Transforming your photo with advanced AI algorithms</div>
            </div>
            
            <div class="circular-loader">
                <div class="outer-circle"></div>
                <div class="image-preview-container">
                    <img id="loadingImage" class="preview-image-loading" src="" alt="Preview">
                    <div class="scan-line"></div>
                </div>
                <div class="pulse-ring"></div>
            </div>
            
            <div class="loading-status">
                <div class="status-text" id="statusText">Initializing AI engine</div>
                <div class="status-description" id="statusDescription">Preparing neural networks for processing</div>
            </div>
            
            <div class="progress-container">
                <div class="progress-info">
                    <div class="progress-text" id="progressText">0%</div>
                    <div class="progress-time" id="progressTime">Estimated time: 15s</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            
            <div class="loading-steps">
                <div class="step active" id="step1">1</div>
                <div class="step" id="step2">2</div>
                <div class="step" id="step3">3</div>
                <div class="step" id="step4">4</div>
                <div class="step" id="step5">5</div>
                <div class="step" id="step6">6</div>
            </div>
        </div>
        
        <!-- Cyberpunk Loading (Version 2) -->
        <div class="cyberpunk-loading" id="cyberpunkLoading">
            <div class="cyber-header">
                <div class="cyber-title">NEURAL PROCESSOR</div>
                <div class="cyber-subtitle">AI-PHOTO CONVERSION IN PROGRESS</div>
            </div>
            
            <div class="cyber-container">
                <div class="cyber-visual">
                    <div class="cyber-image-frame">
                        <img id="cyberImage" class="cyber-image" src="" alt="Preview">
                        <div class="cyber-scan"></div>
                    </div>
                    
                    <div class="cyber-processor">
                        <div class="processor-title">NEURAL NETWORK STATUS</div>
                        <div class="processor-bars">
                            <div class="processor-bar bar-1">
                                <div class="processor-fill" id="cyberBar1"></div>
                                <div class="processor-label">
                                    <span>Face Detection</span>
                                    <span id="bar1Text">0%</span>
                                </div>
                            </div>
                            <div class="processor-bar bar-2">
                                <div class="processor-fill" id="cyberBar2"></div>
                                <div class="processor-label">
                                    <span>Style Transfer</span>
                                    <span id="bar2Text">0%</span>
                                </div>
                            </div>
                            <div class="processor-bar bar-3">
                                <div class="processor-fill" id="cyberBar3"></div>
                                <div class="processor-label">
                                    <span>Detail Enhancement</span>
                                    <span id="bar3Text">0%</span>
                                </div>
                            </div>
                        </div>
                        <div class="cyber-grid"></div>
                    </div>
                </div>
                
                <div class="cyber-status">
                    <div class="cyber-status-text" id="cyberStatusText">INITIALIZING PROCESSOR</div>
                    <div class="cyber-progress">
                        <div class="cyber-progress-fill" id="cyberProgressFill"></div>
                    </div>
                    <div class="cyber-percentage">
                        <span>PROCESSING</span>
                        <span id="cyberPercentage">0%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div>Â© 2023 Zain Developer. All rights reserved.</div>
            <div class="footer-links">
                <a href="#" class="footer-link">Privacy Policy</a>
                <a href="#" class="footer-link">Terms of Service</a>
                <a href="#" class="footer-link">Contact</a>
            </div>
            <div style="margin-top: 15px; color: var(--text-secondary); font-size: 0.8rem;">
                This tool uses AI to convert photos to anime style. No images are stored on our servers.
            </div>
        </div>
    </footer>

    <script>
        // API Configuration from the plugin
        const API_CONFIG = {
            baseUrl: 'https://aienhancer.ai',
            headers: {
                'User-Agent': 'Mozilla/5.0 (Linux; Android 10)',
                'Content-Type': 'application/json',
                'origin': 'https://aienhancer.ai',
                'referer': 'https://aienhancer.ai/photo-to-anime-converter'
            }
        };

        // Style settings from the plugin
        const STYLE_SETTINGS = {
            anime: "L7p91uXhVyp5OOJthAyqjSqhlbM+RPZ8+h2Uq9tz6Y+4Agarugz8f4JjxjEycxEzuj/7+6Q0YY9jUvrfmqkucAl/+qryNmYNVy6ndccs12kKvEph2JWqGX7Y3E6K1TIOuuZU7DlC3+XXHt7v6H58zbZqcWX9gRl1eMwWSUMaGTXA63S/FmmHZbzAuWw0EMOiUTD61YPwrfkXMaTGbj/ANYrjQmJ+oEF7rgQawjLCWb+TtSokamC48KVGqY1gXzWhZz3D5YYvD3QRjYmfHTNJpMp62FnhG7bXUuABGRU0h7tOeNua+qtL/l9k8xl54FkNTrOvbeHr0CX3pagD4uAYLB77CcGNjdIXK9otrH59BVNDzUMILDOFxK6ivAuNDX19zvZfDgKMI0/rxkojyuladw==",
            ghibli: "L7p91uXhVyp5OOJthAyqjSqhlbM+RPZ8+h2Uq9tz6Y+4Agarugz8f4JjxjEycxEzuj/7+6Q0YY9jUvrfmqkucAl/+qryNmYNVy6ndccs12kKvEph2JWqGX7Y3E6K1TIOuuZU7DlC3+XXHt7v6H58zbZqcWX9gRl1eMwWSUMaGTXA63S/FmmHZbzAuWw0EMOiUTD61YPwrfkXMaTGbj/ANa2W+vXedrRNL69qOO2kAyinFACvCnI92dPkhiZYuUz4ziNGVWmjQyZ/1WLtfZqIpDNmdsa6fHRRti5Qh1ehMJPltGo+Cr5HMM2GijVWWBw9mJk0GK7lAYjgJ3WhU9Uf+3G6h60IkRFiP3fwNlT9WdBkyWoU1EjDwAWscxTzxP5C4eifIPbvXx7s5W53crT6bA==",
            manga: "L7p91uXhVyp5OOJthAyqjSqhlbM+RPZ8+h2Uq9tz6Y+4Agarugz8f4JjxjEycxEzuj/7+6Q0YY9jUvrfmqkucAl/+qryNmYNVy6ndccs12kKvEph2JWqGX7Y3E6K1TIOuuZU7DlC3+XXHt7v6H58zbZqcWX9gRl1eMwWSUMaGTXA63S/FmmHZbzAuWw0EMOiUTD61YPwrfkXMaTGbj/ANcncfLQOC0nsvWPnYab5J9WXOEbry/uxd7mq+nl8cpWYgGX8eRd9UBT2amxq0VmV/mq3TGfs2OVny5D9fJyE8uftCyOLiy3S69WoF5Q6kty1wQB0DUCmXSCxNf6XYFOo1edHJsrANqlxYQvlE7fcuqrWO+nlApVUi1w1FqBHgqvtbb8tQ+ZuOS4O5tKHrUikfQ==",
            blocky: "L7p91uXhVyp5OOJthAyqjSqhlbM+RPZ8+h2Uq9tz6Y+4Agarugz8f4JjxjEycxEzuj/7+6Q0YY9jUvrfmqkucAl/+qryNmYNVy6ndccs12kKvEph2JWqGX7Y3E6K1TIOuuZU7DlC3+XXHt7v6H58zbZqcWX9gRl1eMwWSUMaGTXA63S/FmmHZbzAuWw0EMOiUTD61YPwrfkXMaTGbj/ANQynlUeOWEWPXtFZQVm9ze9eD7JHWgYB776oVwnnAjnMDc09YdnTHYCIJ/FNQJ1XD1EbtN7fT973qmsZAyQbvgi0jrYvY8pb0TL9Ucb0uvVZIJAxKXmTu0yNoj5xsk/yaByPlAByqirQDS93FPt3lNfBn0nn/5DJBnauU5SSllZK1BuAiOtK5y4eWjNLBT2+F9rK5fo1oJC7AkRAX+htTWcMQuY0cXPfYARQLYUOcHwbF0o7Y1lKnsgBVHaUGmx+/A==",
            "chinese-ink": "L7p91uXhVyp5OOJthAyqjSqhlbM+RPZ8+h2Uq9tz6Y+4Agarugz8f4JjxjEycxEzuj/7+6Q0YY9jUvrfmqkucAl/+qryNmYNVy6ndccs12kKvEph2JWqGX7Y3E6K1TIOuuZU7DlC3+XXHt7v6H58zbZqcWX9gRl1eMwWSUMaGTXA63S/FmmHZbzAuWw0EMOiUTD61YPwrfkXMaTGbj/ANXAqlula6QmFJcyeXkezRm5uL3o454Pdx8v3iItk7T83LUa1ugFreuO63Nplxo0aomKBlV04vrw+1zs807J/XoavvfxpwGGwnXEDUG83DucSCIv7hOuulu4EtbHm7k2M8RgNqQ+Cdxhy9v+Ibm3gvJrm+LW9/9ObYos9DQF5xWe7vdG6KPa+0HtHuKGb+CdhJg==",
            minimalist: "L7p91uXhVyp5OOJthAyqjSqhlbM+RPZ8+h2Uq9tz6Y+4Agarugz8f4JjxjEycxEzuj/7+6Q0YY9jUvrfmqkucAl/+qryNmYNVy6ndccs12kKvEph2JWqGX7Y3E6K1TIOuuZU7DlC3+XXHt7v6H58zbZqcWX9gRl1eMwWSUMaGTXA63S/FmmHZbzAuWw0EMOiUTD61YPwrfkXMaTGbj/ANcdrJgI4S8aZwd9To23kckE6cZoDRmU28+npLXJ5HnmXRGfcTgAo9+HkGFlzwwluaCxBhymjjk5EsWfkqNxSupctTt95IFHNrEYbq6jkcbv8AQK279uQXFHzVq55lEEcudKrAz22eRbXI16I2V9LO9L3tFwb6XWyxmGgc/EChlygzgXT7bfAp7vdEX0GFPgNuoKFEDdE9Y1vswXs8UG49IdaghvcPHGCBv5xwdVeD4r0nsqBfOjsv/Dl6CfR+o4cehAgJOfD/IDYvg8cemD56Ns="
        };

        // DOM Elements
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const imagePreview = document.getElementById('imagePreview');
        const previewImage = document.getElementById('previewImage');
        const styleSelect = document.getElementById('styleSelect');
        const convertBtn = document.getElementById('convertBtn');
        const uploadError = document.getElementById('uploadError');
        const uploadErrorText = document.getElementById('uploadErrorText');
        const resultContainer = document.getElementById('resultContainer');
        const resultImage = document.getElementById('resultImage');
        const defaultOutput = document.getElementById('defaultOutput');
        const downloadBtn = document.getElementById('downloadBtn');
        const anotherBtn = document.getElementById('anotherBtn');
        const apiError = document.getElementById('apiError');
        const apiErrorText = document.getElementById('apiErrorText');
        
        // Settings Elements
        const settingsBtn = document.getElementById('settingsBtn');
        const settingsPanel = document.getElementById('settingsPanel');
        const loadingStyleSelect = document.getElementById('loadingStyleSelect');
        const loadingSpeedSelect = document.getElementById('loadingSpeedSelect');
        const imagePreviewSelect = document.getElementById('imagePreviewSelect');
        
        // Loading Overlay Elements
        const loadingOverlay = document.getElementById('loadingOverlay');
        const closeLoadingBtn = document.getElementById('closeLoadingBtn');
        const modernLoading = document.getElementById('modernLoading');
        const cyberpunkLoading = document.getElementById('cyberpunkLoading');
        const loadingImage = document.getElementById('loadingImage');
        const statusText = document.getElementById('statusText');
        const statusDescription = document.getElementById('statusDescription');
        const progressText = document.getElementById('progressText');
        const progressTime = document.getElementById('progressTime');
        const progressFill = document.getElementById('progressFill');
        const steps = document.querySelectorAll('.step');
        
        // Cyberpunk Elements
        const cyberStatusText = document.getElementById('cyberStatusText');
        const cyberProgressFill = document.getElementById('cyberProgressFill');
        const cyberPercentage = document.getElementById('cyberPercentage');
        const cyberBar1 = document.getElementById('cyberBar1');
        const cyberBar2 = document.getElementById('cyberBar2');
        const cyberBar3 = document.getElementById('cyberBar3');
        const bar1Text = document.getElementById('bar1Text');
        const bar2Text = document.getElementById('bar2Text');
        const bar3Text = document.getElementById('bar3Text');
        const cyberImage = document.getElementById('cyberImage');

        // Variables
        let originalImageBase64 = null;
        let convertedImageUrl = null;
        let currentTaskId = null;
        let pollingInterval = null;
        
        // Loading System Variables
        let loadingProgress = 0;
        let progressInterval;
        let stepIndex = 0;
        let statusIndex = 0;
        let loadingSpeed = 'normal';
        
        // High-quality image URLs for loading preview
        const highQualityImages = [
            "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
            "https://images.unsplash.com/photo-1494790108755-7846c1dcbb31?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
            "https://images.unsplash.com/photo-1500648767791-00fccbbd2b14?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
            "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
            "https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
            "https://images.unsplash.com/photo-1524504388940-b1c1722653e1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80"
        ];
        
        // Status messages for AI processing
        const statusMessages = [
            { text: "Initializing AI engine", desc: "Loading neural network models" },
            { text: "Analyzing photo", desc: "Detecting faces and features" },
            { text: "Processing image data", desc: "Extracting color and texture information" },
            { text: "Applying anime style", desc: "Transforming with selected art style" },
            { text: "Enhancing details", desc: "Refining edges and improving quality" },
            { text: "Finalizing result", desc: "Applying final touches and optimization" },
            { text: "Processing complete", desc: "Your anime artwork is ready!" }
        ];
        
        // Cyberpunk status messages
        const cyberStatusMessages = [
            "INITIALIZING NEURAL PROCESSOR",
            "ANALYZING INPUT DATA",
            "EXTRACTING FACIAL FEATURES",
            "APPLYING STYLE TRANSFER",
            "ENHANCING DETAILS",
            "OPTIMIZING OUTPUT",
            "PROCESSING COMPLETE"
        ];

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            // File input change event
            fileInput.addEventListener('change', handleFileSelect);
            
            // Drag and drop events
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            uploadArea.addEventListener('drop', handleDrop);
            
            // Convert button click
            convertBtn.addEventListener('click', convertToAnime);
            
            // Download button click
            downloadBtn.addEventListener('click', downloadResult);
            
            // Another button click
            anotherBtn.addEventListener('click', resetConverter);
            
            // Close loading button click
            closeLoadingBtn.addEventListener('click', stopLoading);
            
            // Settings button click
            settingsBtn.addEventListener('click', toggleSettingsPanel);
            
            // Close settings when clicking outside
            document.addEventListener('click', closeSettingsOnClickOutside);
            
            // Update loading speed when changed
            loadingSpeedSelect.addEventListener('change', updateLoadingSpeed);
            
            // Hide error containers initially
            uploadError.classList.remove('active');
            apiError.classList.remove('active');
        });

        // Toggle settings panel
        function toggleSettingsPanel(event) {
            event.stopPropagation();
            settingsPanel.classList.toggle('active');
        }

        // Close settings when clicking outside
        function closeSettingsOnClickOutside(event) {
            if (!settingsPanel.contains(event.target) && !settingsBtn.contains(event.target)) {
                settingsPanel.classList.remove('active');
            }
        }

        // Update loading speed
        function updateLoadingSpeed() {
            loadingSpeed = loadingSpeedSelect.value;
        }

        // Handle file selection
        function handleFileSelect(event) {
            const file = event.target.files[0];
            processFile(file);
        }

        // Handle drag over
        function handleDragOver(event) {
            event.preventDefault();
            event.stopPropagation();
            uploadArea.classList.add('dragover');
        }

        // Handle drag leave
        function handleDragLeave(event) {
            event.preventDefault();
            event.stopPropagation();
            uploadArea.classList.remove('dragover');
        }

        // Handle drop
        function handleDrop(event) {
            event.preventDefault();
            event.stopPropagation();
            uploadArea.classList.remove('dragover');
            
            const file = event.dataTransfer.files[0];
            processFile(file);
        }

        // Process selected file
        function processFile(file) {
            // Reset errors
            hideError(uploadError);
            
            // Validate file
            if (!file) {
                showError(uploadError, uploadErrorText, 'No file selected.');
                return;
            }
            
            // Validate file type
            const validTypes = ['image/jpeg', 'image/jpg', 'image/png'];
            if (!validTypes.includes(file.type)) {
                showError(uploadError, uploadErrorText, 'Invalid file type. Please upload a JPG or PNG image.');
                return;
            }
            
            // Validate file size (5MB max)
            const maxSize = 5 * 1024 * 1024; // 5MB in bytes
            if (file.size > maxSize) {
                showError(uploadError, uploadErrorText, 'File is too large. Maximum size is 5MB.');
                return;
            }
            
            // Preview image
            previewFile(file);
            
            // Convert to base64
            convertToBase64(file);
            
            // Enable convert button
            convertBtn.disabled = false;
        }

        // Preview image
        function previewFile(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                previewImage.src = e.target.result;
                imagePreview.classList.add('active');
                loadingImage.src = e.target.result;
                cyberImage.src = e.target.result;
            };
            
            reader.readAsDataURL(file);
        }

        // Convert image to base64
        function convertToBase64(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                // Remove data URL prefix (e.g., "data:image/jpeg;base64,")
                const base64String = e.target.result.split(',')[1];
                originalImageBase64 = base64String;
            };
            
            reader.readAsDataURL(file);
        }

        // Start loading overlay with progress simulation
        function startLoading() {
            // Reset variables
            loadingProgress = 0;
            stepIndex = 0;
            statusIndex = 0;
            
            // Get selected loading style
            const loadingStyle = loadingStyleSelect.value;
            
            // Show the selected loading style
            if (loadingStyle === 'modern') {
                modernLoading.style.display = 'block';
                cyberpunkLoading.style.display = 'none';
            } else {
                modernLoading.style.display = 'none';
                cyberpunkLoading.style.display = 'block';
            }
            
            // Reset UI for both loading styles
            resetLoadingUI();
            
            // Show loading overlay
            loadingOverlay.classList.add('active');
            
            // Start progress simulation
            simulateLoadingProgress();
        }

        // Reset loading UI
        function resetLoadingUI() {
            // Reset modern loading
            progressFill.style.width = '0%';
            progressText.textContent = '0%';
            progressTime.textContent = 'Estimated time: 15s';
            statusText.textContent = statusMessages[0].text;
            statusDescription.textContent = statusMessages[0].desc;
            
            // Reset steps
            steps.forEach(step => {
                step.classList.remove('active', 'completed');
            });
            steps[0].classList.add('active');
            
            // Reset cyberpunk loading
            cyberProgressFill.style.width = '0%';
            cyberPercentage.textContent = '0%';
            cyberStatusText.textContent = 'INITIALIZING PROCESSOR';
            cyberBar1.style.width = '0%';
            cyberBar2.style.width = '0%';
            cyberBar3.style.width = '0%';
            bar1Text.textContent = '0%';
            bar2Text.textContent = '0%';
            bar3Text.textContent = '0%';
        }

        // Stop loading overlay
        function stopLoading() {
            // Hide loading overlay
            loadingOverlay.classList.remove('active');
            
            // Clear intervals
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
        }

        // Simulate loading progress
        function simulateLoadingProgress() {
            if (progressInterval) {
                clearInterval(progressInterval);
            }
            
            // Set speed based on selection
            let intervalTime = 100; // normal
            if (loadingSpeed === 'fast') intervalTime = 50;
            if (loadingSpeed === 'slow') intervalTime = 200;
            
            progressInterval = setInterval(() => {
                // Increment progress (faster at beginning, slower at end)
                let increment = 1;
                if (loadingProgress > 80) increment = 0.3;
                else if (loadingProgress > 50) increment = 0.7;
                
                // Adjust based on speed
                if (loadingSpeed === 'fast') increment *= 2;
                if (loadingSpeed === 'slow') increment *= 0.5;
                
                loadingProgress += increment;
                
                // Cap at 99% until API completes
                if (loadingProgress >= 99) {
                    loadingProgress = 99;
                }
                
                // Update progress display
                updateLoadingProgress();
                
                // Update status messages
                updateStatusMessages();
                
                // Update image effect
                updateImageEffect();
            }, intervalTime);
        }

        // Update loading progress display
        function updateLoadingProgress() {
            // Update progress for modern loading
            progressFill.style.width = `${loadingProgress}%`;
            progressText.textContent = `${Math.floor(loadingProgress)}%`;
            
            // Update estimated time
            const remaining = Math.max(0, Math.floor((100 - loadingProgress) / 2));
            progressTime.textContent = `Estimated time: ${remaining}s`;
            
            // Update progress for cyberpunk loading
            cyberProgressFill.style.width = `${loadingProgress}%`;
            cyberPercentage.textContent = `${Math.floor(loadingProgress)}%`;
            
            // Update individual bars with different speeds for realism
            const bar1Progress = Math.min(100, loadingProgress * 1.2);
            const bar2Progress = Math.min(100, loadingProgress * 0.9);
            const bar3Progress = Math.min(100, loadingProgress * 1.1);
            
            cyberBar1.style.width = `${bar1Progress}%`;
            cyberBar2.style.width = `${bar2Progress}%`;
            cyberBar3.style.width = `${bar3Progress}%`;
            
            bar1Text.textContent = `${Math.floor(bar1Progress)}%`;
            bar2Text.textContent = `${Math.floor(bar2Progress)}%`;
            bar3Text.textContent = `${Math.floor(bar3Progress)}%`;
            
            // Update steps
            updateSteps();
        }

        // Update image effect
        function updateImageEffect() {
            // Add subtle pulse effect to images during processing
            if (loadingProgress > 10 && loadingProgress < 90) {
                loadingImage.classList.add('loading');
                cyberImage.classList.add('loading');
            } else {
                loadingImage.classList.remove('loading');
                cyberImage.classList.remove('loading');
            }
            
            // Gradually increase image brightness as processing progresses
            const brightness = 1.0 + (loadingProgress / 100 * 0.2);
            const contrast = 1.0 + (loadingProgress / 100 * 0.1);
            
            loadingImage.style.filter = `brightness(${brightness}) contrast(${contrast})`;
            cyberImage.style.filter = `brightness(${brightness}) contrast(${contrast})`;
        }

        // Update status messages
        function updateStatusMessages() {
            // Change status based on progress
            if (loadingProgress >= 0 && loadingProgress < 15 && statusIndex !== 0) {
                statusIndex = 0;
            } else if (loadingProgress >= 15 && loadingProgress < 30 && statusIndex !== 1) {
                statusIndex = 1;
            } else if (loadingProgress >= 30 && loadingProgress < 45 && statusIndex !== 2) {
                statusIndex = 2;
            } else if (loadingProgress >= 45 && loadingProgress < 60 && statusIndex !== 3) {
                statusIndex = 3;
            } else if (loadingProgress >= 60 && loadingProgress < 75 && statusIndex !== 4) {
                statusIndex = 4;
            } else if (loadingProgress >= 75 && loadingProgress < 90 && statusIndex !== 5) {
                statusIndex = 5;
            } else if (loadingProgress >= 90 && statusIndex !== 6) {
                statusIndex = 6;
            }
            
            // Update status text for modern loading
            statusText.textContent = statusMessages[statusIndex].text;
            statusDescription.textContent = statusMessages[statusIndex].desc;
            
            // Update status for cyberpunk loading
            cyberStatusText.textContent = cyberStatusMessages[statusIndex];
        }

        // Update steps
        function updateSteps() {
            // Determine which step should be active based on progress
            let newStepIndex = Math.floor(loadingProgress / 16.7); // 6 steps, each ~16.7%
            
            if (newStepIndex !== stepIndex && newStepIndex < steps.length) {
                // Mark previous steps as completed
                for (let i = 0; i < newStepIndex; i++) {
                    steps[i].classList.remove('active');
                    steps[i].classList.add('completed');
                }
                
                // Set current step as active
                if (newStepIndex < steps.length) {
                    steps[newStepIndex].classList.add('active');
                    steps[newStepIndex].classList.remove('completed');
                }
                
                stepIndex = newStepIndex;
            }
        }

        // Complete loading and show success
        function completeLoading() {
            // Set progress to 100%
            loadingProgress = 100;
            progressFill.style.width = '100%';
            progressText.textContent = '100%';
            progressTime.textContent = 'Processing complete!';
            
            cyberProgressFill.style.width = '100%';
            cyberPercentage.textContent = '100%';
            cyberBar1.style.width = '100%';
            cyberBar2.style.width = '100%';
            cyberBar3.style.width = '100%';
            bar1Text.textContent = '100%';
            bar2Text.textContent = '100%';
            bar3Text.textContent = '100%';
            
            // Complete all steps
            steps.forEach(step => {
                step.classList.remove('active');
                step.classList.add('completed');
            });
            
            statusText.textContent = "Processing complete!";
            statusDescription.textContent = "Your anime artwork is ready for download";
            cyberStatusText.textContent = "PROCESSING COMPLETE";
            
            // Clear interval
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
            
            // Hide loading after 1 second
            setTimeout(() => {
                stopLoading();
            }, 1000);
        }

        // Convert to anime using the API from the plugin
        async function convertToAnime() {
            // Validate
            if (!originalImageBase64) {
                showError(uploadError, uploadErrorText, 'Please upload an image first.');
                return;
            }
            
            // Get selected style
            const selectedStyle = styleSelect.value;
            
            // Show loading overlay
            startLoading();
            
            // Hide result and default output
            resultContainer.classList.remove('active');
            defaultOutput.style.display = 'none';
            hideError(apiError);
            
            // Disable convert button during processing
            convertBtn.disabled = true;
            
            try {
                // Step 1: Create conversion task
                const createResponse = await fetch(`${API_CONFIG.baseUrl}/api/v1/r/image-enhance/create`, {
                    method: 'POST',
                    headers: API_CONFIG.headers,
                    body: JSON.stringify({
                        model: 5,
                        image: `data:image/jpeg;base64,${originalImageBase64}`,
                        settings: STYLE_SETTINGS[selectedStyle]
                    })
                });
                
                if (!createResponse.ok) {
                    throw new Error(`Server responded with status: ${createResponse.status}`);
                }
                
                const createResult = await createResponse.json();
                
                if (!createResult?.data?.id) {
                    throw new Error('No task ID received from server.');
                }
                
                currentTaskId = createResult.data.id;
                
                // Step 2: Poll for result
                await pollForResult();
                
            } catch (error) {
                // Show error
                showError(apiError, apiErrorText, `Conversion failed: ${error.message}. Please try again.`);
                stopLoading();
                defaultOutput.style.display = 'block';
                convertBtn.disabled = false;
                
                // Clear polling interval if exists
                if (pollingInterval) {
                    clearInterval(pollingInterval);
                    pollingInterval = null;
                }
            }
        }

        // Poll for conversion result
        async function pollForResult() {
            let attempts = 0;
            const maxAttempts = 30; // Max 30 attempts (90 seconds total)
            
            const checkResult = async () => {
                attempts++;
                
                try {
                    const resultResponse = await fetch(`${API_CONFIG.baseUrl}/api/v1/r/image-enhance/result`, {
                        method: 'POST',
                        headers: API_CONFIG.headers,
                        body: JSON.stringify({ task_id: currentTaskId })
                    });
                    
                    if (!resultResponse.ok) {
                        throw new Error(`Result check failed with status: ${resultResponse.status}`);
                    }
                    
                    const result = await resultResponse.json();
                    
                    if (result?.data?.status === 'succeeded') {
                        // Success! Display the result
                        displayResult(result.data.output);
                        
                        // Complete loading animation
                        completeLoading();
                        
                        // Clear interval
                        if (pollingInterval) {
                            clearInterval(pollingInterval);
                            pollingInterval = null;
                        }
                        
                        return true;
                    } else if (result?.data?.status === 'failed') {
                        throw new Error('Conversion failed on the server.');
                    }
                    
                    // If max attempts reached, throw error
                    if (attempts >= maxAttempts) {
                        throw new Error('Conversion timeout. Please try again.');
                    }
                    
                    return false;
                    
                } catch (error) {
                    // Clear interval
                    if (pollingInterval) {
                        clearInterval(pollingInterval);
                        pollingInterval = null;
                    }
                    
                    throw error;
                }
            };
            
            // Try immediately first
            if (!(await checkResult())) {
                // Then poll every 3 seconds
                pollingInterval = setInterval(async () => {
                    try {
                        await checkResult();
                    } catch (error) {
                        showError(apiError, apiErrorText, `Conversion failed: ${error.message}. Please try again.`);
                        stopLoading();
                        defaultOutput.style.display = 'block';
                        convertBtn.disabled = false;
                    }
                }, 3000);
            }
        }

        // Display conversion result
        function displayResult(imageUrl) {
            // Set result image
            resultImage.src = imageUrl;
            convertedImageUrl = imageUrl;
            
            // Show result container
            resultContainer.classList.add('active');
            
            // Re-enable convert button
            convertBtn.disabled = false;
        }

        // Download result
        function downloadResult() {
            if (!convertedImageUrl) return;
            
            // Create a temporary link element
            const link = document.createElement('a');
            link.href = convertedImageUrl;
            link.download = `anime-${styleSelect.value}-${Date.now()}.png`;
            
            // Append to document, click, and remove
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Reset converter
        function resetConverter() {
            // Stop any ongoing polling
            if (pollingInterval) {
                clearInterval(pollingInterval);
                pollingInterval = null;
            }
            
            // Stop loading overlay
            stopLoading();
            
            // Reset file input
            fileInput.value = '';
            
            // Reset image preview
            imagePreview.classList.remove('active');
            previewImage.src = '';
            loadingImage.src = '';
            cyberImage.src = '';
            
            // Reset result
            resultContainer.classList.remove('active');
            resultImage.src = '';
            convertedImageUrl = null;
            currentTaskId = null;
            
            // Reset button
            convertBtn.disabled = true;
            
            // Reset errors
            hideError(uploadError);
            hideError(apiError);
            
            // Show default output
            defaultOutput.style.display = 'block';
            
            // Reset base64
            originalImageBase64 = null;
            
            // Reset loading steps
            steps.forEach(step => {
                step.classList.remove('active', 'completed');
            });
            steps[0].classList.add('active');
        }

        // Show error
        function showError(errorElement, errorTextElement, message) {
            errorTextElement.textContent = message;
            errorElement.classList.add('active');
        }

        // Hide error
        function hideError(errorElement) {
            errorElement.classList.remove('active');
        }
    </script>
</body>
</html>